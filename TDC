#include <iostream>
#include <string>
using namespace std;

void Destino (string d [30][9], int x,int c [9]);
void ImprimirDestinos(string d[30][9], int x, int c[9], int &b, int  &n);
void ID_Aviones(int a[9], int &b, int &c);

int main(){
	bool salir = false;
	int no_valido = 0;
	int cant_av = 0;
	int Cuba = 0;
	int Nicaragua = 0;
	int aviones [9] = {0,0,0,0,0,0,0,0,0};
	int aux = 0;
	string destino[30][9];
	int Opcion = 0;
	int seguridad = 0;
	
	while (salir != true){
		cout << "===========================================" << endl;
		cout << "Sistema de Control de la Aerolinea CONVIASA" << endl;
		cout << "===========================================" << endl;
		cout << endl << "Seleccione una de las siguientes opciones:" << endl;
		cout << "1. Ingresar las ID de los aviones disponibles de la Aerolinea" << endl;
		cout << "2. Ingresar los destinos aviones disponibles en el mes" << endl;
		cout << "3. Ver la informacion individual de cada avion" << endl;
		cout << "4. Salir" << endl;
		cin >> Opcion;
		
		switch(Opcion){
			case 1:
				cout << endl;
				cout << "Opcion Seleccionada: " << Opcion << endl;
				cout << endl;
				ID_Aviones(aviones, no_valido, cant_av);
				cout << endl;
				break;
			case 2:
				cout << endl;
				cout << "Opcion Seleccionada: " << Opcion << endl;
				cout << endl;
				if (aviones[0] == 0){
					cout << "Debe ingresar las ID de los aviones disponibles antes de ingresar sus destinos" << endl;
					cout << endl;
					break;
				} else {
				Destino(destino, cant_av, aviones);
				cout << endl;
				break;
				}
			case 3:
				cout << endl;
				cout << "Opcion Seleccionada: " << Opcion << endl;
				cout << endl;
				if (aviones[0] == 0){
					cout << "Debe ingresar las ID de los aviones disponibles antes de ingresar sus destinos" << endl;
					cout << endl;
					break;
				} else {
				ImprimirDestinos(destino, cant_av, aviones, Cuba, Nicaragua);
				cout << endl;
				break;
				}
			case 4:
				cout << endl;
				cout << "Opcion Seleccionada: " << Opcion << endl;
				salir = true;
				break;
			default:
				cout << "Error: La opcion ingresada no es valida" << endl;
				seguridad++;
				if(seguridad >= 3){
					cout << endl;
					cout << "Ha ingresado demasiados intentos no validos el programa se cerrara como medida de seguridad" << endl;
					salir = true;
				}
				break;	
		}
	}
	
	return 0;
}

void Destino(string d [30][9], int x, int c [9]){
	int p = 0;
	cout << "Ingrese el destino de vuelo para los aviones de la aerolinea" << endl;
    cout << "C --- Cuba" << endl << "N --- Nicaragua" << endl << "Digite (X) para terminar" << endl;
    
    for (int i = 0; i < x; i++) {
    	cout << "Destino del avion con el ID: " << c[i] << endl;
        for (int j = 0; j < 30; j++){ 
			cin >> d[j][i];
        	
			if(j == 13 || j == 27){
				d[j][i] = "R";
				cout << "El avion no puede volar al destino indicado debe pasar un proceso de reparacion" << endl;
				cout << "Por favor reprograme el vuelo" << endl;
				continue;
        	}
        	
        	while (d[j][i] != "C" && d[j][i] != "N" && d[j][i] != "X"){
            	cout<<"Error: debe que introducir C para Cuba, N para Nicaragua y X para terminar" << endl;
            	cin >> d[j][i];
            	p++;
				if (p == 5){
					cout << "Ha ingresado demasiados intentos no validos el programa se cerrara como medida de seguridad" << endl;
					d[j][i] = "X";
					break;	
				}
			}
			
			if (d[j][i] == d[j-1][i] && d[j][i] == d[j-2][i]){
        		cout << "Error: El avion no puede realizar el vuelo a la ubicacion descrita, ingrese otra ubicacion o concluya" << endl;
        		d[j][i] = " ";
        		j--;
        		p++;
				if (p == 5){
					cout << "Ha ingresado demasiados intentos no validos el programa se cerrara como medida de seguridad" << endl;
					d[j][i] = "X";
					break;	
				}
			}
			
    		if (d[j][i] == "X"){
    		break;
			}
    	}
    	if (p == 5){
    		break;
    	}
	}
}

void ImprimirDestinos(string d[30][9], int x, int c[9], int &b, int  &n){ 
	cout << "Lista de destinos para cada avion:" << endl; 
	for (int i = 0; i < x; i++) { 
		cout << "ID del avion: " << c[i] << endl; 
		cout << "Destinos: "; 
		for (int j = 0; j < 30; j++) { 
			if (d[j][i] == "X") { 
				break;
			}
			if (d[j][i] == "C"){
				b++;
			}
			if (d[j][i] == "N"){
				n++;
			}
			cout << d[j][i] << " "; 
		}
			cout << endl;
			cout << "El avion de ID " << c[i] << " tiene " << b << " vuelos a Cuba y " << n << " vuelos a Nicaragua" << endl;
			b = 0;
			n = 0;
	} 
}

void ID_Aviones(int a[9], int &b, int &c){
	cout<<"Digite las ID de los aviones disponibles de la aerolinea (Limite: 9)" << endl;
	cout<<"Recuerde que los Id no deben exceder los tres digtos" << endl;
	cout<<"Si la cantidad de aviones disponibles no logra alcanzar el limite digite 0 para concluir" << endl;
	cout << "Las ID que inician en 0 y 00 forman parte de la USA-ID-SYSTEM no estan disponibles en nuestro pais" << endl;
	
	for (int i = 0; i < 9; i ++){
		cin >> a[i];
		if (a[i] == 0){
			break;
		}
		if (a[i] > 999 || a[i] < 100){
			cout << "Ha ingresado una ID no valida, no se tendra en cuenta por favor ingrese nuevamente la ID" << endl;
			a[i] = 0;
			i--;
			b++;
		}
		if (b >= 9){
			cout <<"Ha ingresado demasiados intentos no validos el programa se cerrara como medida de seguridad" << endl;
			break;
		}
		c++;
	}
}
